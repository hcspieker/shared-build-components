name: Reusable Workflow to Build .NET Web Applications

on:
  workflow_call:
    inputs:
      runner-name:
        description: 'NAme of the github action runner'
        required: false
        type: string
        default: 'ubuntu-latest'
      enable-scss-compile:
        description: 'Enable SCSS compilation'
        required: false
        type: boolean
        default: false
      node-version:
        description: 'Note.js version'
        required: false
        type: string
        default: '20.x'
      css-directory:
        description: 'CSS directory path'
        required: false
        type: string
        default: 'wwwroot/css'
      dotnet-version:
        description: '.NET version'
        required: false
        type: string
        default: '9.0.x'
      build-configuration:
        description: 'Build configuration (e.g. Debug, Release)'
        required: false
        type: string
        default: 'Release'
      build-filter:
        description: 'Build artifact (e.g. path to project / solution or filter (**/*.csproj)'
        required: false
        type: string
        default: '**/*.csproj'
      test-filter:
        description: 'Build artifact (e.g. path to project / solution or filter (**/*.csproj)'
        required: false
        type: string
        default: '**/*[Tt]ests/*.csproj'
      publish-filter:
        description: 'Artifact to be published'
        required: false
        type: string
        default: '**/*.csproj'
      enable-tests:
        description: 'Enable test execution'
        required: false
        type: string
        default: 'true'
      enable-publish:
        description: 'Enable publishing the created artifacts'
        required: false
        type: string
        default: 'false'
      artifact-name:
        description: 'Name of the published artifacts'
        required: false
        type: string
        default: 'dotNetApp'
 
jobs:
  build:
    runs-on: ${{ inputs.runner-name }}
    steps:
    - uses: actions/checkout@v4
  
    - name: Compile SCSS
      uses: hcspieker/shared-build-components/.github/actions/scss-compile@v1.1.0
      if: ${{ inputs.enable-scss-compile }}
      with:
        css-directory: ${{ inputs.css-directory }}

    - name: Build dotnet projects
      uses: hcspieker/shared-build-components/.github/actions/dotnet-build@v1.1.0
      with:
        dotnet-version: ${{ inputs.dotnet-version }}
        build-configuration: ${{ inputs.build-configuration }}
        build-filter: ${{ inputs.build-filter }}
        test-filter: ${{ inputs.test-filter }}
        publish-filter: ${{ inputs.publish-filter }}
        enable-tests: ${{ inputs.enable-tests }}
        enable-publish: ${{ inputs.enable-publish }}
        artifact-name: ${{ inputs.artifact-name }}
